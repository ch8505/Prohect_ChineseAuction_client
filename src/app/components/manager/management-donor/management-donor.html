<div class="mb-3">
    <p-button label="הוסף תורם חדש" icon="pi pi-plus" (click)="openNew()"></p-button>
</div>

<p-table [value]="listOfDonors" class="p-datatable-striped">
    <ng-template pTemplate="header">
        <tr>
            <th>קוד</th>
            <th>שם</th>
            <th>email</th>
            <th>phone</th>
            <th>הוספת מתנה לתורם</th>
            <th>edit</th>
            <th>delete</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-donor>
        <tr>
            <td>{{donor.id}}</td>
            <td>{{donor.name}}</td>
            <td>{{donor.email}}</td>
            <td>{{donor.phone}}</td>
            <td class="flex gap-2">
                <p-button icon="pi pi-plus" [text]="true" (click)="openGiftDialog(donor)">הוסף מתנה</p-button>
            </td>
            <td class="flex gap-2">
                <p-button icon="pi pi-pencil" [text]="true" (click)="onEdit(donor)">עדכון</p-button>
            </td>
            <td>
                <p-button icon="pi pi-trash" [text]="true" severity="danger" (click)="delete(donor.id)">מחק</p-button>
            </td>
        </tr>
    </ng-template>
</p-table>

@if(displayDialog) {
<p-dialog [header]="selectedDonor ? 'עריכת תורם' : 'הוספת תורם'" [(visible)]="displayDialog" [modal]="true"
    [style]="{ width: '400px' }">
    <app-donor-form [donorToEdit]="selectedDonor" (save)="saveDonor($event)" (cancel)="displayDialog = false">
    </app-donor-form>
</p-dialog>
}

@if(displayGiftDialog) {
<p-dialog header="הוספת מתנה לתורם" [(visible)]="displayGiftDialog" [modal]="true">
    <app-gift-form [categories]="categories" (save)="addGiftToDonor($event)" (cancel)="displayGiftDialog = false">
    </app-gift-form>
</p-dialog>
}